// http://paulirish.com/2011/requestanimationframe-for-smart-animating/
// http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating
// requestAnimationFrame polyfill by Erik MÃ¶ller
// fixes from Paul Irish and Tino Zijdel
(function(){var e=0,t=["ms","moz","webkit","o"];for(var n=0;n<t.length&&!window.requestAnimationFrame;++n){window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"]}window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var r=(new Date).getTime(),i=Math.max(0,16-(r-e)),s=window.setTimeout(function(){t(r+i)},i);e=r+i;return s});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})})();Object.prototype.clone=function(){var e=this instanceof Array?[]:{};for(var t in this){if(t==="clone")continue;this[t]&&typeof this[t]=="object"?e[t]=this[t].clone():e[t]=this[t]}return e};window.onload=function(){function v(){ctx.clearRect(0,0,t,n);for(var e=r.length-1;e>=0;e--){ctx.beginPath();ctx.moveTo(r[e].tlX,r[e].tlY);ctx.lineTo(r[e].trX,r[e].trY);ctx.lineTo(r[e].brX,r[e].brY);ctx.lineTo(r[e].blX,r[e].blY);ctx.closePath();ctx.fillStyle=r[e].color1;ctx.fill();ctx.stroke()}}function m(){v();requestAnimationFrame(m)}function S(e){w=e;w!==E&&x(E,0);x(e,20);E=w}function x(e,t){var n=e;r[n].tlX=originRects[e].tlX-t;r[e].tlY=originRects[e].tlY-t;r[e].trX=originRects[e].trX+t;r[e].trY=originRects[e].trY-t;r[e].brX=originRects[e].brX+t;r[e].brY=originRects[e].brY+t;r[e].blX=originRects[e].blX-t;r[e].blY=originRects[e].blY+t;var i=e+s;console.log(i);r[i].brX=originRects[i].brX+t;r[i].brY=originRects[i].brY-t;r[i].blX=originRects[i].blX-t;r[i].blY=originRects[i].blY-t;var o=i-1;r[o].blX=originRects[o].blX+t;r[o].blY=originRects[o].blY-t;var u=e-1;console.log(u)}console.log("We are ready!");var e=1;c=document.getElementById("c");ctx=c.getContext("2d");var t=window.innerWidth,n=window.innerHeight;ctx.canvas.width=t;ctx.canvas.height=n;window.onresize=function(e){t=window.innerWidth;n=window.innerHeight;ctx.canvas.width=t;ctx.canvas.height=n};var r=[],i=300,s=10,o=10,u=s*o,a=["105B63","F4FFBE","FFD34E","DB7004","BD342D"];ctx.strokeStyle="rgba(0, 0, 0, 0.3)";for(var f=u-1;f>=0;f--){r[f]={};var l=(s-f%s)*i-i,h=(o-Math.floor(f/s))*i-i;r[f].tlX=l;r[f].tlY=h;r[f].trX=l+i;r[f].trY=h;r[f].brX=l+i;r[f].brY=h+i;r[f].blX=l;r[f].blY=h+i;var p=a[Math.floor(Math.random()*a.length)],d=a[Math.floor(Math.random()*a.length)];r[f].color1="#"+p;r[f].color2="#"+d}originRects=r.clone();requestAnimationFrame(m);var g=0,y=!1,b=[];c.addEventListener("mousedown",function(){g=0;y=!0},!1);c.addEventListener("mousemove",function(e){g=1;if(y){var t=e.x/i,n=e.y/i,r=t%1,u=n%1,a=Math.ceil(r+u),f=Math.floor(n)*s+Math.ceil(t);f=s*o-f;console.log("Id: "+f+"Side:"+a);S(f)}},!1);c.addEventListener("mouseup",function(){y=!1;g===0?console.log("click"):g===1&&console.log("drag done")},!1);var w,E=0;window.onscroll=function(t){var n=($(".container").scrollLeft()-100)/e;n*=-1;var i=($(".container").scrollTop()-100)/e;i*=-1;console.log(n);$(".container").scrollLeft(100);$(".container").scrollTop(100);$(".c").css({marginLeft:"+="+n+"px",marginTop:"+="+i+"px"});for(var s=r.length-1;s>=0;s--){r[s].tlX+=n;r[s].tlY+=i;r[s].trX+=n;r[s].trY+=i;r[s].brX+=n;r[s].brY+=i;r[s].blX+=n;r[s].blY+=i}clearTimeout($.data(this,"scrollTimer"));$.data(this,"scrollTimer",setTimeout(function(){console.log("Haven't scrolled in 250ms!");$("html").removeClass("zoom");setTimeout(function(){},500)},250));t.preventDefault();return!1}};